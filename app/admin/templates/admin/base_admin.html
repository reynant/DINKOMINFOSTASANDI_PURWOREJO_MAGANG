<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{% block title %}Admin Dashboard{% endblock %} - Kominfo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css"
    />
    <style>
      .custom-scrollbar::-webkit-scrollbar {
        width: 6px;
      }
      .custom-scrollbar::-webkit-scrollbar-track {
        background: #f1f1f1;
      }
      .custom-scrollbar::-webkit-scrollbar-thumb {
        background: #a5b4fc;
        border-radius: 3px;
      }
      .custom-scrollbar::-webkit-scrollbar-thumb:hover {
        background: #818cf8;
      }
      @keyframes scaleIn {
        from {
          opacity: 0;
          transform: scale(0.95);
        }
        to {
          opacity: 1;
          transform: scale(1);
        }
      }
      .animate-scaleIn {
        animation: scaleIn 0.2s ease-out;
      }
    </style>
  </head>
  <body class="bg-gray-100">
    <div class="relative min-h-screen lg:flex">
      <div
        id="sidebar-overlay"
        class="fixed inset-0 bg-black/60 z-30 hidden lg:hidden"
      ></div>
      <aside
        id="sidebar"
        class="fixed inset-y-0 left-0 z-40 w-64 transform -translate-x-full transition-transform duration-300 ease-in-out lg:relative lg:translate-x-0"
      >
        {% include "admin/sidebar.html" %}
      </aside>

      <div class="flex-1 flex flex-col h-screen">
        <header
          class="sticky top-0 z-20 flex items-center justify-between bg-white/95 backdrop-blur-sm shadow-md px-4 sm:px-6 py-3"
        >
          <div class="flex items-center gap-4">
            <button
              id="burger-btn"
              class="lg:hidden text-gray-700 text-2xl focus:outline-none"
            >
              <i class="bi bi-list"></i>
            </button>
            <h1 class="text-lg sm:text-xl font-bold text-gray-800">
              {% block page_title %}Dashboard{% endblock %}
            </h1>
          </div>
          <div class="relative">
            <button id="userMenuButton" class="flex items-center space-x-2 text-gray-600 hover:text-purple-600 transition-all duration-300 hover:scale-105">
              <div class="relative">
                <i class="bi bi-person-circle text-xl animate-float"></i>
                  <div class="absolute -top-1 -right-1 w-3 h-3 bg-green-400 rounded-full animate-pulse-custom"></div>
                  </div>
                  <span class="hidden sm:inline">
                    ðŸ‘‹ <strong>{{ (session.user or 'User') | capitalize }}</strong>
                  </span>
                <i class="bi bi-chevron-down transition-transform duration-200"></i>
            </button>
            <div id="userMenuDropdown"
                 class="hidden absolute right-0 mt-2 w-48 bg-white/95 backdrop-blur-sm rounded-xl shadow-2xl py-2 z-50 animate-scaleIn border border-purple-100">
              <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-purple-50 hover:text-purple-600 transition-all duration-200">
                <i class="bi bi-person-badge mr-2"></i> Profile
              </a>
              <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-purple-50 hover:text-purple-600 transition-all duration-200">
                <i class="bi bi-gear mr-2"></i> Settings
              </a>
              <div class="border-t border-gray-100 my-1"></div>
              <a href="{{ url_for('admin.logout') }}" onclick="return confirm('Apakah Anda yakin ingin logout?')"
                 class="block px-4 py-2 text-sm text-red-600 hover:bg-red-50 transition-all duration-200">
                <i class="bi bi-box-arrow-right mr-2"></i> Logout
              </a>
            </div>
          </div>
        </header>
        <main class="flex-1 overflow-y-auto p-6 custom-scrollbar">
          {% block content %}{% endblock %}
        </main>
        <footer
          class="text-center text-xs text-gray-500 py-4 px-6 border-t bg-white"
        >
          Â© 2014-2025
          <a href="#" class="text-indigo-600 font-semibold"
            >Dinas Komunikasi, Informatika, Statistik dan Persandian Kabupaten
            Purworejo</a
          >.
        </footer>
      </div>
    </div>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const burgerBtn = document.getElementById("burger-btn");
        const sidebar = document.getElementById("sidebar");
        const overlay = document.getElementById("sidebar-overlay");
        function toggleSidebar() {
          sidebar.classList.toggle("-translate-x-full");
          overlay.classList.toggle("hidden");
        }
        if (burgerBtn && sidebar && overlay) {
          burgerBtn.addEventListener("click", toggleSidebar);
          overlay.addEventListener("click", toggleSidebar);
        }
        const userMenuButton = document.getElementById("userMenuButton");
        const userMenuDropdown = document.getElementById("userMenuDropdown");
        if (userMenuButton && userMenuDropdown) {
          const chevronIcon = userMenuButton.querySelector(".bi-chevron-down");
          userMenuButton.addEventListener("click", (e) => {
            e.stopPropagation();
            userMenuDropdown.classList.toggle("hidden");
            chevronIcon.style.transform = userMenuDropdown.classList.contains(
              "hidden"
            )
              ? "rotate(0deg)"
              : "rotate(180deg)";
          });
          document.addEventListener("click", () => {
            if (!userMenuDropdown.classList.contains("hidden")) {
              userMenuDropdown.classList.add("hidden");
              chevronIcon.style.transform = "rotate(0deg)";
            }
          });
        }
      });
    </script>

    {% block scripts %}{% endblock %}
  </body>
</html>
